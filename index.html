<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>有給休暇管理表Webアプリ</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1 class="StyleTitle ">有給休暇管理表Webアプリ</h1>
    <h2 id="titleYear" class="StyleTitle2">2020年度　年次有給休暇管理表</h2>
    <div class="buttonbox">ファイル保存</div>

    <table id="infoTable" class="tableStyle" border="1" width="70%"
        style="border:none; border-collapse: collapse; font-size:10pt">
        <tr>
            <td id = "referenceDate" class="ex_border_tlr" colspan="10">基準日：2020/4/1</td>
        </tr>
        <tr>
            <td id = "yearEnd" class="ex_border_tlr" colspan="10"><span>年度末（2021/3/31）までに、必ず、５日以上取得してください。</span></td>
        </tr>
        <tr>
            <td width="8%" style="font-weight:bold;">社員番号</td>
            <td width="9%">
                <input id="employeeNumber" type="text" size="6" style="padding:0 0 0 0;width:95%;height:100%;">
            </td>
            <td width="8%" style="font-weight:bold;">氏名</td>
            <td width="15%">
                <input id="name" type="text" style="width:95%;">
            </td>
            <td width="12%" style="font-weight:bold;">前年度繰越日数</td>
            <td width="8%">
                <select id="carryForwardDays" style="width:60%;" name="前年度">
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                </select>
                日
            </td>
            <td width="12%" style="font-weight:bold;">新規付与日数</td>
            <td width="8%">
                <select id="grantDays" style="width:60%;" name="新規">
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                </select>
                日
            </td>
            <td width="12%" style="font-weight:bold;">今年度年休総数</td>
            <td width="8%">
                <div id="totalPaidDays">20日</div>
            </td>
        </tr>
    </table><br>

    <table id="acquisitionPlanTable" class="tableStyle" border="1" width="70%"
        style="border-collapse: collapse; font-size:10pt">
        <thead>
            <tr bgcolor="lightgrey">
                <td class="ex_border_r" colspan="2" width="25%" style="text-align:left; font-weight:bold;">年次有給休暇取得計画希望書
                </td>
                <td class="ex_border_l" colspan="3" width="72%" style="text-align:left; font-weight:bold;">
                    <span>対象者：入社３年目以降（入社２年目までは記入しないでください。）</span></td>
            </tr>
            <tr bgcolor="lightgrey">
                <th width="11%">日付</th>
                <th width="14%">区分
                    <img src="./img/help.gif" onmouseover="showHelpPopUp('help_period_msg', 'help_period', event)"
                        onmouseout="hideHelpPopUp('help_period')">
                </th>
                <th width="15%">取得日数(総数)</th>
                <th width="15%">残日数</th>
                <th width="42%">備考</th>
            </tr>
            <tr>
                <td width="12%"> <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="計画年休">計画年休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%"><input type="text" style="width:98%" value=""></td>
            </tr>
            <tr>
                <td width="12%"> <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="計画年休">計画年休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%"><input type="text" style="width:98%" value=""></td>
            </tr>
            <tr>
                <td width="12%"> <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="計画年休">計画年休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%"><input type="text" style="width:98%" value=""></td>
            </tr>
        </thead>
    </table><br>

    <table id="administrationTable" class="tableStyle"  border="1" width="70%"
        style="border:none; border-collapse: collapse; font-size:10pt">
        <thead>
            <tr bgcolor="lightgrey">
                <td class="ex_border_r" colspan="2" width="25%" style="text-align:left; font-weight:bold;">年次有給休暇管理表
                </td>
                <td class="ex_border_l" colspan="3" width="72%" style="text-align:left; font-weight:bold;">
                    <span>↓　計画年休の対象者は、取得日数を4.0日または3.5日から開始してください。</span></td>
            </tr>
            <tr bgcolor="lightgrey">
                <th width="11%">日付</th>
                <th width="14%">区分
                    <img src="./img/help.gif" onmouseover="showHelpPopUp('help_period_msg', 'help_period', event)"
                        onmouseout="hideHelpPopUp('help_period')">
                </th>
                <th width="15%">取得日数(総数)</th>
                <th width="15%">残日数</th>
                <th width="42%">理由</th>
            </tr>
            <tr>
                <td width="12%"> <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="全休">全休</option>
                        <option value="半休">半休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="体調不良">体調不調</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td width="12%"> <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="全休">全休</option>
                        <option value="半休">半休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="体調不良">体調不調</option>
                    </select></td>
                </td>
            </tr>
            <tr>
                <td width="12%"> <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="全休">全休</option>
                        <option value="半休">半休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="体調不良">体調不調</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td width="12%"> <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="全休">全休</option>
                        <option value="半休">半休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="体調不良">体調不調</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td width="12%">
                    <select id="month" name="month"></select> / <select id="date" name="date"></select>
                </td>
                <td width="14%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="全休">全休</option>
                        <option value="半休">半休</option>
                    </select>
                </td>
                <td width="15%" style="text-align:right">日</td>
                <td width="15%" style="text-align:right">日</td>
                <td width="42%">
                    <select style="width:98%;" name="区分">
                        <option value="空白"></option>
                        <option value="体調不良">体調不調</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td class="Rowbutton" colspan="1">
                    <input type="button" value="+" onclick="insertRow(this)">
                    <input type="button" value="-" onclick="deleteRow(this)">
                </td>
                <td class="ex_border_tlr"　id = "expiratioDate" colspan="8">有効期限：2021/3/31</td>
            </tr>
        </thead>
    </table><br>

    <table class="tableStyle" id="ruleTable" border="1" width="70%" style="border-collapse: collapse; font-size:10pt">
        <tr bgcolor="lightgrey">
            <td class="ex_border_br" colspan="3" width="100%" style="text-align:left; font-weight:bold;">計画年休運用ルール</td>
        </tr>
        <tr>
            <td class="ex_border_t" bgcolor="lightgrey" width="5%"></td>
            <td width="45%" style="text-align:left">本社勤務者</td>
            <td width="45%" style="text-align:left">客先勤務者</td>
        </tr>
        <tr>
            <td class="ex_border_br" width="5%">1</td>
            <td class="ex_border_l" colspan="2" width="45%" style="text-align:left">対象者</td>
        </tr>
        <tr>
            <td class="ex_border_t" width="5%"></td>
            <td width="45%" style="text-align:left">入社３年目以降の社員</td>
            <td width="45%" style="text-align:left">同左</td>
        </tr>
        <tr>
            <td class="ex_border_br" width="5%">2</td>
            <td class="ex_border_l" colspan="2" width="45%" style="text-align:left">時期および日数</td>
        </tr>
        <tr>
            <td class="ex_border_t" width="5%"></td>
            <td width="45%" style="text-align:left">７月～９月の間で<span>連続</span>３日間を取得すること。</td>
            <td width="45%" style="text-align:left">
                ①事業所毎の年間カレンダーに年休一斉付与日が設定されている場合は、当該日を優先して指定する事。<br>②３日から上記①を除いた日数を４月～翌年３月の間で指定すること。</th>
        </tr>
        <tr>
            <td class="ex_border_br" width="5%">3</td>
            <td class="ex_border_l" colspan="2" width="45%" style="text-align:left">申出方法</td>
        </tr>
        <tr>
            <td class="ex_border_t" width="5%"></td>
            <td width="45%" style="text-align:left">4/30までにチーム長へ希望日を申し出て、承認を得ること。</td>
            <td width="45%" style="text-align:left">初日の休暇取得希望日の1ケ月前までにチーム長へ申し出て、承認を得ること。</td>
        </tr>
        <tr>
            <td class="ex_border_br" width="5%">※</td>
            <td class="ex_border_l" colspan="2" width="45%" style="text-align:left">注意事項</td>
        </tr>
        <tr>
            <td class="ex_border_t" width="5%"></td>
            <td colspan="2" width="45%" style="text-align:left"><span>承認後の日程変更は原則認められません。必ず３日取得するようにしてください。</spa>
            </td>
        </tr>
    </table>
</body>

<script>
    const year = 2020;

    window.onload = function () {
        hoge();
    };

    function hoge() {
        // ライブラリ
        /**
         * 任意の年が閏年であるかをチェックする
         * @param {number} チェックしたい西暦年号
         * @return {boolean} 閏年であるかを示す真偽値
         */
        const isLeapYear = year => (year % 4 === 0) && (year % 100 !== 0) || (year % 400 === 0);

        /**
         * 任意の年の2月の日数を数える
         * @param {number} チェックしたい西暦年号
         * @return {number} その年の2月の日数
         */
        const countDatesOfFeb = year => isLeapYear(year) ? 29 : 28;

        /**
         * セレクトボックスの中にオプションを生成する
         * @param {string} セレクトボックスのDOMのid属性値
         * @param {number} オプションを生成する最初の数値
         * @param {number} オプションを生成する最後の数値
         * @param {number} 現在の日付にマッチする数値
         */
        const createOption = (id, startNum, endNum, current) => {
            const selectDom = document.getElementById(id);
            let optionDom = '';
            for (let i = startNum; i <= endNum; i++) {
                if (i === current) {
                    option = '<option value="' + i + '" selected>' + i + '</option>';
                } else {
                    option = '<option value="' + i + '">' + i + '</option>';
                }
                optionDom += option;
            }
            selectDom.insertAdjacentHTML('beforeend', optionDom);
        }

        // DOM
        // const yearBox = document.getElementById('year');
        const monthBox = document.getElementById('month');
        const dateBox = document.getElementById('date');

        // 日付データ
        const today = new Date();
        const thisYear = today.getFullYear();
        const thisMonth = today.getMonth() + 1;
        const thisDate = today.getDate();

        let datesOfYear = [31, countDatesOfFeb(thisYear), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

        // イベント
        monthBox.addEventListener("change", (e) => {
            dateBox.innerHTML = '';
            const selectedMonth = e.target.value;
            createOption('date', 1, datesOfYear[selectedMonth - 1], 1);
        });
        createOption('month', 1, 12, thisMonth);
        createOption('date', 1, datesOfYear[thisMonth - 1], thisDate);
    }
</script>

</html>